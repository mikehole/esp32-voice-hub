; PlatformIO Project Configuration File
; ESP32 Voice Hub - Waveshare ESP32-S3-Knob-Touch-LCD-1.8

[env:esp32s3]
platform = espressif32@~6.6.0
board = waveshare_s3_knob
framework = arduino

; ---- Serial / Upload ----
monitor_speed = 115200
upload_speed = 921600
upload_port = COM5

; ---- CPU / Flash ----
board_build.mcu = esp32s3
board_build.f_cpu = 240000000L

; If your module is really 16MB, keep these.
; Note: PlatformIOâ€™s "board" still reports N8/no-PSRAM, but these settings override it.
board_build.flash_mode = qio
board_build.flash_size = 16MB
board_build.partitions = default_16MB.csv

; ---- PSRAM ----
; Most Waveshare ESP32-S3 modules with PSRAM are OPI (octal).
; Keep qio_opi unless you KNOW yours is different.
board_build.arduino.memory_type = qio_opi

; ---- Build flags ----
build_flags =
    ; PSRAM + USB
    -DBOARD_HAS_PSRAM
    -DARDUINO_USB_CDC_ON_BOOT=1
    -DARDUINO_USB_MODE=1

    ; LVGL config
    -DLV_CONF_INCLUDE_SIMPLE
    -DLV_CONF_PATH="${PROJECT_DIR}/src/lv_conf.h"

    ; Display pins (ST77916 QSPI) - from your current config
    -DLCD_CS=14
    -DLCD_PCLK=13
    -DLCD_DATA0=15
    -DLCD_DATA1=16
    -DLCD_DATA2=17
    -DLCD_DATA3=18
    -DLCD_RST=21
    -DLCD_BL=47

    ; Touch pins (CST816) - from your current config
    -DTOUCH_SDA=5
    -DTOUCH_SCL=4
    -DTOUCH_INT=6
    -DTOUCH_RST=7

; ---- Libraries ----
lib_deps =
    lvgl/lvgl@^8.4.0
    ; Keep a fixed version if you want maximum reproducibility:
    ; waveshare/ESP32_Display_Panel@^1.1.1
    ESP32_Display_Panel

; ---- Suggested LDF behavior for Arduino + LVGL projects ----
lib_ldf_mode = chain+